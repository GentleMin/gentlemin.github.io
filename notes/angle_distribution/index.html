<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="XwhPCxJ23A4vdp_xBFDnsoJelhGwCPELOda48Hw_GLQ"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>How similar are random vectors in high dimensions? | Geowanderer | Jingtao Min Homepage</title> <meta name="author" content="Jingtao Min"> <meta name="description" content="Given two random vectors in high-dimensional space, how similar are they expected to be?"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://gentlemin.github.io/notes/angle_distribution/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Geowanderer</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/notes/">Notes</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repos</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/publications/">Publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/teaching/">Teaching</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">How similar are random vectors in high dimensions?</h1> <p class="post-description">Given two random vectors in high-dimensional space, how similar are they expected to be?</p> </header> <article> <p>Consider two random vectors in high-dimensional space, how are their angular separation distributed? Do they tend to be more “similar”, or less “similar”, at high dimensions? This is the small question I want to address here.</p> <p>The motivation comes from comparing vectors that are solutions to PDEs discretized using spectral method. The solution can be considered “converged” when the solution vectors “align” at different resolutions (different dimensions). A simple way to measure this “alignment”, or “similarity”, is to calculate the angular separation between the two vectors, or the inner product of the two normalized vectors, defined as</p> \[\cos &lt; \mathbf{a},\mathbf{b} &gt; = \frac{\langle \mathbf{a}, \mathbf{b} \rangle}{\|\mathbf{a}\|\|\mathbf{b}\|} = \frac{\mathbf{a}^\top \mathbf{b}}{\|\mathbf{a}\|\|\mathbf{b}\|}\] <p>but then comes the problem: do I need to adjust my criterion for “good” alignment? If \(\cos &lt; \mathbf{a},\mathbf{b} &gt; = 0.99\) when \(\mathbf{a},\mathbf{b} \in \mathbb{R}^3\), it is somewhat good alignment. If the same inner product \(\cos &lt; \mathbf{a},\mathbf{b} &gt; = 0.99\) occurs for , say \(\mathbf{a},\mathbf{b} \in \mathbb{R}^{100}\), is it as good, worse, or better? In other words, if I get two random vectors in a 3-dimensional and an 100-dimensional space, are the odds that they align at \(\cos &lt; \mathbf{a},\mathbf{b} &gt; = 0.99\) different?</p> <p><br></p> <hr> <h2 id="preparation-surface-of-n-sphere-band-element">Preparation: surface of \(n\)-sphere, band element</h2> <p>I use the terminology that an \(n\)-sphere is an \(n\)-dimensional manifold, embedded in an \(n+1\)-Euclidean space, formed by points with equal distance to the origin. Therefore, points \(\pm R\) on the real axis is a \(0\)-sphere, a circle is a \(1\)-sphere, a (normal) sphere is a \(2\)-sphere.</p> <p>To begin, we first need the surface of a unit \(n\)-sphere, which I shall denote as \(S_n\). The surface of an \(n\)-sphere with radius \(R\) is then \(S_n R^n\). There are simpler derivations available, but let us look at the brute-force method because as a mid-step, we can obtain the band-element on the unit \(n\)-sphere. For this purpose, let us look at the \(n\)-sphere as a series of \((n-1)\)-spheres (with varying radius) stacked in one dimension. For instance, a circle is a combination of two-point-segments (with varying segment length) combined in one direction, and a sphere is a combination of circles (with different radius) stacked in one direction. Following this logic, we can write \(S_n\) as</p> \[S_n = \int_{-1}^{+1} S_{n-1} r^{n-1} \frac{dx}{\sqrt{1 - x^2}}\] <p>where the weight \((1 - x^2)^{-1/2}\) accounts for the slope of the surface, and \(r = \sqrt{1 - x^2}\) is the radius of the \((n-1)\)-sphere element at \(x\). Immediately this indicates that a <strong><em>“band-element”, or the surface area corresponding to \(dx\) at \(x\)</em></strong> is given by</p> \[dS_{n} = S_{n-1} r^{n-2} \, dx = S_{n-1} (1 - x^2)^{\frac{n-2}{2}} dx\] <p>and the total area</p> \[S_n = \int dS_{n} = S_{n-1} \int_{-1}^1 (1 - x^2)^{\frac{n-2}{2}} \, dx = S_{n-1} I_{n-1}.\] <p>Integral \(I_{n}\) can be calculated by standard trigonometric change of variables, integration by parts and establishing the recurrence relations. The process yields a simple close-form expression</p> \[I_{n} = \int_{-1}^1 (1 - x^2)^{\frac{n-1}{2}} dx = \int_0^\pi \sin^{n} \theta \, d\theta = \frac{\Gamma(\frac{n+1}{2})}{\Gamma(\frac{n+2}{2})} \sqrt{\pi}.\] <p>Successive product of this integral cancels out most of the terms, leaving</p> \[\prod_{j=0}^n I_j = \pi^{\frac{n+1}{2}} \frac{\Gamma(\frac{1}{2})}{\Gamma(\frac{n+2}{2})} = \frac{\pi^{\frac{n+2}{2}}}{\Gamma(\frac{n+2}{2})}.\] <p>In the end, we reach the expression for <strong><em>the surface area of the unit \(n\)-sphere</em></strong></p> \[S_n = S_{n-1} I_{n-1} = S_0 \prod_{j=0}^{n-1} I_j = \frac{2\pi^{\frac{n+1}{2}}}{\Gamma(\frac{n+1}{2})}.\] <p><br></p> <hr> <h2 id="uniform-distribution-of-vectors-on-unit-n-sphere">Uniform distribution of vectors on unit \(n\)-sphere</h2> <p>For a normalized vector random variable \(\mathbf{x} \in \mathbb{R}^n\) , it is effectively an element of the unit \((n-1)\)-sphere, i.e. \(\mathbf{x} \in \mathbb{S}^{n-1}\). Uniform distribution on this unit \((n-1)\)-sphere is given by</p> \[p(\mathbf{x}) = S_{n-1}^{-1} = \frac{\Gamma(\frac{n}{2})}{2\pi^{\frac{n}{2}}}\] <p>Vector \(\mathbf{x}\) that satisfy this distribution is denoted as \(\mathbf{x} \sim U(\mathbb{S}^{n-1})\). Due to isotropy, if a vector random variable \(\mathbf{x} \in \mathbb{R}^n\) is uniformly distributed in the complete space \(\mathbb{R}^n\) (\(\mathbf{x}\sim U(\mathbb{R}^n)\)) , then its normalization should follow \(p\), the uniform distribution on \(\mathbb{S}^{n-1}\). Thus \(p\) is the angular uniform distribution.</p> <p>In the derivation above we obtained the band element, the surface area corresponding to \(dx\) in any direction. This turns out useful as it immediately yields the marginal distribution of the uniform distribution on \(\mathbb{S}^{n-1}\) in any direction:</p> \[p_i(x_i) = S_{n-2} (1 - x_i^2)^{\frac{n-3}{2}} \times S_{n-1}^{-1} = \pi^{-\frac{1}{2}} \frac{\Gamma(\frac{n}{2})}{\Gamma(\frac{n-1}{2})} (1 - x_i^2)^{\frac{n-3}{2}}\] <p><br></p> <hr> <h2 id="distribution-of-angular-separation">Distribution of angular separation</h2> <p>Now it is time to return to the original problem. Given two random vectors in \(\mathbb{R}^n\) space, how is their angular separation distributed? Let us consider random vectors \(\mathbf{a},\mathbf{b} \in \mathbb{R}^n\). The goal is to characterize the distribution of the resulting random variable \(z=\langle \hat{\mathbf{a}}, \hat{\mathbf{b}} \rangle = \cos&lt;\mathbf{a},\mathbf{b}&gt;\).</p> <p>For \(\mathbf{a},\mathbf{b} \sim U(\mathbb{R}^n)\) or \(\hat{\mathbf{a}}, \hat{\mathbf{b}} \sim U(\mathbb{S}^{n-1})\), the solution has now become quite simple thanks to the results from previous sections. Indeed, without loss of generality, we can always rotate the coordinate system such that axis \(x_1\) aligns with the first vector \(\mathbf{a}\). \(\hat{\mathbf{a}}\) then has coordinates \((1,0,\cdots)\). The inner product then becomes \(\langle \hat{\mathbf{a}}, \hat{\mathbf{b}} \rangle = \hat{b}_1\), i.e. the coordinate of \(\hat{\mathbf{b}}\) along this axis. The question is then essentially what is the distribution of \(\hat{b}_1\), given that \(\hat{\mathbf{b}} \sim U(\mathbb{S}^{n-1})\). This is nothing but the marginal distribution of any coordinate \(x_i\) obtained earlier, and hence</p> \[p(z) = p(\langle \hat{\mathbf{a}}, \hat{\mathbf{b}} \rangle) = \pi^{-\frac{1}{2}} \frac{\Gamma(\frac{n}{2})}{\Gamma(\frac{n-1}{2})} (1 - z^2)^{\frac{n-3}{2}}\] <p>Or converted to the angle variable \(\theta = \arccos z\) ,</p> \[p(\theta) = p(z) \left|\frac{dz}{d\theta}\right| = \pi^{-\frac{1}{2}} \frac{\Gamma(\frac{n}{2})}{\Gamma(\frac{n-1}{2})} (\sin \theta)^{n-2}\] <p>Now the conclusion becomes clear. When the vectors are uniformly distributed (whether in \(\mathbb{R}^n\) or on \(\mathbb{S}^{n-1}\)), neither the angular separation between the vectors nor the normalized inner product follows a uniform distribution in general. For both quantities, the distribution would get increasingly shifted towards an orthogonal state, i.e. \(z=\langle \hat{\mathbf{a}}, \hat{\mathbf{b}} \rangle = 0\) and \(\theta = \pi/2\). For \(p(\theta)\), all except the \(n=2\) case have angular separation more likely towards orthogonal state; at \(n=2\) (a circle), \(p(\theta)\) is constant across all angles. For \(p(z)\), all \(n &gt; 3\) cases have angular separation more likely towards orthogonal state; at \(n=3\) (a sphere), \(p(z)\) is contant whereas at \(n=2\) (a circle), \(z\) is more likely to be \(\pm 1\) (aligned or anti-aligned). An illustration can be found below.</p> <div class="row justify-content-center"> <div class="col-sm-12"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/p_angle_sep-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/p_angle_sep-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/p_angle_sep-1400.webp"></source> <img src="/assets/img/p_angle_sep.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Probability density function of separation angle (top) and its cosine (bottom). </div> <p>It is however worth mentioning that due to even symmetry with respect to \(z\) (or \(\theta = \pi/2\)), two random vectors on arbitrary \(n\)-sphere are always, <em>on average</em>, orthogonal. To be more precise, \(\forall n\),</p> \[\mathbb{E}_{\mathbf{a},\mathbf{b}\sim U(\mathbb{S}^{n})}[z] = \mathbb{E}_{\mathbf{a},\mathbf{b}\sim U(\mathbb{S}^{n})}[\langle \mathbf{a}, \mathbf{b} \rangle] \equiv 0,\quad \mathbb{E}_{\mathbf{a},\mathbf{b}\sim U(\mathbb{S}^{n})}[\theta] \equiv \frac{\pi}{2}.\] <p>The variance and other moments can be computed accordingly, at least numerically. The variance decreases as \(n\) increases, as the distribution is increasingly shifted towards vectors being orthogonal.</p> <p><br></p> <hr> <h2 id="open-question-generalization">Open question: generalization</h2> <p>A uniform distribution on an \(n\)-sphere \(U(\mathbb{S}^{n})\) is a special case of the <a href="[von%20Mises%E2%80%93Fisher%20distribution%20-%20Wikipedia](https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution)">von Mises-Fisher distribution</a>, with concentration parameter \(\kappa = 0\). A natural further question is therefore, given two i.i.d. random vectors drawn from a general von Mises-Fisher distribution, what is the distribution of their angular separation \(\theta\), or their inner product \(z = \langle \mathbf{a}, \mathbf{b} \rangle\)?</p> <p>This problem seems more challenging than the uniform distribution case, as a general von Mises-Fisher distribution has a mean direction, creating anisotropy. However, given the vast materials in statistics, and my relative ignorance, I very much expect a solution to have already been derived long ago. If this is the case, than what derived here might just be a special case.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2026 Jingtao Min. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. <a href="https://hits.sh/gentlemin.github.io_notes/angle_distribution.md" rel="external nofollow noopener" target="_blank"><img alt="Hits" src="https://hits.sh/gentlemin.github.io_notes/angle_distribution.md.svg?color=9277f0"></a> </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script> <script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{})});</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>