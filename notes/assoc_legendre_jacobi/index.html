<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="XwhPCxJ23A4vdp_xBFDnsoJelhGwCPELOda48Hw_GLQ"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Associated Legendre function to one-sided Jacobi polynomial | Geowanderer | Jingtao Min Homepage</title> <meta name="author" content="Jingtao Min"> <meta name="description" content="An interesting observation - associated Legendre functions are just one-sided Jacobi polynomials in disguise - with some prefactors"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://gentlemin.github.io/notes/assoc_legendre_jacobi/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Geowanderer</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/notes/">Notes</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repos</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/publications/">Publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/teaching/">Teaching</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Associated Legendre function to one-sided Jacobi polynomial</h1> <p class="post-description">An interesting observation - associated Legendre functions are just one-sided Jacobi polynomials in disguise - with some prefactors</p> </header> <article> <h1 id="background">Background</h1> <p>For a field \(f\) bounded within a sphere expanded in cylindrical coordinates, what would it look like on the surface, expanded in spherical harmonics? Conversely, for a field on the surface of the sphere, what is its projection onto the cylindrical basis? In other words, expanding \(f\) as</p> \[f = \sum_{m,n} f_{mn}^s s^m P_n^{(\alpha^s, \beta^s)}(2s^2 - 1) + \sum_{m,n} f_{mn}^a z s^m P_n^{(\alpha^a, \beta^a)}(2s^2 - 1) = \sum_{\ell,m} q_{\ell m} P_\ell^m(z)\] <p>where \(s = \sqrt{1 - z^2}\), we want to know the transformation that links \((f_{nm}^s, f_{nm}^a)\) to \(q_{\ell m}\), and vice versa. These are the question of interest and its answer will be a necessary step in implementing the magnetic boundary condition in the \(\Psi\)G model, and has been partially done in @holdenried-chernoff_surface_2020. In this process, I stumbled upon a strange identity, which links the associated Legendre function to certain one-sided Jacobi polynomials in a one-to-one way. This is described here.</p> <h1 id="associated-legendre-function-to-one-sided-jacobi-polynomial">Associated Legendre function to one-sided Jacobi polynomial</h1> <p><strong>Proposition</strong> Let \(z \in [-1, 1]\). The associated Legendre function \(P_\ell^m\) is related to the one-sided Jacobi polynomial \(P_n^{(\alpha, \beta)}\) via</p> \[P_\ell^m(z) = \left\{\begin{aligned} &amp;C_{\ell m} s^m P_n^{(-\frac{1}{2}, m)}(2s^2 - 1),\quad \ell-m=2n \\ &amp;C_{\ell m} z s^m P_n^{(\frac{1}{2}, m)}(2s^2 - 1),\quad \ell-m=2n+1 \end{aligned}\right.\] <p>where \(s = \sqrt{1 - z^2} \in [0,1]\), \(\ell,m,n \in \mathbb{Z}^*\) with \(\ell \geq m\), and \(C_{\ell m}\) is a constant depending on \(\ell\) and \(m\). Alternatively, introducing \(\chi(l,m)\) as an indicator function for \(l-m\) being odd number, i.e. \(\chi = 1\) when \(\ell - m\) is odd and zero otherwise, we can write this uniformly as</p> \[P_\ell^m(z) = C_{\ell m} z^\chi s^m P_n^{(\chi -\frac{1}{2}, m)}(2s^2 - 1).\] <p><strong><em>Proof</em></strong>: We use brute-force to expand the associated Legendre function \(P_\ell^m\) in closed form, where the trailing polynomial in \(z\) is expanded</p> \[\begin{aligned} P_\ell^m(z) &amp;= \frac{(-1)^m}{2^\ell \ell!} \left(1 - z^2\right)^{\frac{m}{2}} \frac{d^{\ell + m}}{dz^{\ell + m}} (z^2 - 1)^\ell \\ &amp;= C_{\ell m} s^m \frac{d^{\ell + m}}{dz^{\ell + m}} \sum_{k=0}^\ell (-1)^{\ell - k} \begin{pmatrix} \ell \\ k \end{pmatrix} z^{2k} &amp;\qquad C_{\ell m} &amp;= \frac{(-1)^m}{2^\ell \ell!} \\ &amp;= C_{\ell m} s^m \sum_{k\geq \frac{l+m}{2}}^\ell (-1)^{\ell - k} \begin{pmatrix} \ell \\ k \end{pmatrix} \frac{(2k)!}{(2k - \ell -m)!} z^{2k - \ell - m} &amp;\qquad C_{\ell m} &amp;= \frac{(-1)^m}{2^\ell \ell!} \end{aligned}\] <p>Now let us introduce \(n\), as the half difference between \(\ell\) and \(m\), i.e. \(n = \lfloor (l-m)/2 \rfloor\). The spherical harmonic degree \(\ell\) can then be written as \(\ell = m + 2n + \chi\). Then</p> \[\begin{aligned} P_\ell^m(z) &amp;= C_{\ell m} s^m \sum_{k = m+n+\chi}^{m+2n+\chi} (-1)^{m + 2n + \chi - k} \begin{pmatrix} m + 2n + \chi \\ k \end{pmatrix} \frac{(2k)! \, z^{2k - 2m - 2n - \chi}}{(2k - 2m - 2n - \chi)!} \end{aligned}\] <p>Let us now devise a change of summation variable, \(k = m + n + \chi + k'\). Under this transformation,</p> \[\begin{aligned} P_\ell^m(z) &amp;= C_{\ell m} s^m \sum_{k' = 0}^{n} (-1)^{n - k'} \begin{pmatrix} m + 2n + \chi \\ m + n + k' + \chi \end{pmatrix} \frac{(2(m+n+k+\chi))!}{(2k' + \chi)!} z^{2k' + \chi} \\ &amp;= C_{\ell m} z^\chi s^m \sum_{k = 0}^{n} (-1)^{n - k} \frac{(m + 2n + \chi)!(2(m+n+k+\chi))!}{(m + n + k + \chi)!(n-k)!(2k + \chi)!} z^{2k} \\ &amp;= C_{\ell m} z^\chi s^m \sum_{k = 0}^{n} (-1)^{n - k} 2^{2(m+n)+\chi} \frac{(m + 2n + \chi)! \, \Gamma(m+n+k+\chi+\frac{1}{2})}{(n-k)! \, k! \, \Gamma(k + \chi + \frac{1}{2})} z^{2k} \end{aligned}\] <p>where we used the property of the gamma function,</p> \[\frac{(2k)!}{k!} = 2^{2k} \frac{\Gamma(k+\frac{1}{2})}{\Gamma(\frac{1}{2})}, \qquad \forall k \in \mathbb{Z}_{\geq 0}.\] <p>We can just rearrange the terms, making some aesthetic simplification, and collect the constant prefactor, writing it as</p> \[\begin{aligned} P_\ell^m(z) &amp;= A_{nm} z^\chi s^m \sum_{k = 0}^{n} \begin{pmatrix} n \\ k \end{pmatrix} \frac{\Gamma(m+n+k+\chi+\frac{1}{2})}{\Gamma(k + \chi + \frac{1}{2})} (-z^2)^{k} \end{aligned}\] <p>where the constant prefactor is now given by</p> \[\begin{aligned} A_{n m} &amp;= (-1)^{m+n} \frac{2^{2(m+n)+\chi}}{2^\ell \ell!} \frac{(m + 2n + \chi)!}{n!} = (-1)^{m+n} \frac{2^m}{n!} \\ \end{aligned}\] <p>The current form of the associated Legendre polynomial is close enough to the Jacobi polynomials, which have the following series expansion with argument \(2s^2 - 1 = 1 - 2z^2\),</p> \[P_n^{(\chi - \frac{1}{2}, m)}(1 - 2z^2) = B_{nm} \sum_{k=0}^n \begin{pmatrix} n \\ k \end{pmatrix} \frac{\Gamma(m + n + k + \chi + \frac{1}{2})}{\Gamma(k + \chi + \frac{1}{2})} (-z^2)^k\] <p>where the constant prefactor is</p> \[B_{nm} = \frac{\Gamma(\chi + n + \frac{1}{2})}{n! \Gamma(\chi + m + n + \frac{1}{2})}\] <p>Assembling the factors \(z^\chi s^m\), we retrieve the identity between associated Legendre function and the one-sided Jacobi polynomial</p> \[P_\ell^m(z) = C_{nm} z^\chi s^m P_n^{(\chi - \frac{1}{2}, m)}(2s^2 - 1)\] <p>with constant</p> \[C_{nm} = \frac{A_{nm}}{B_{nm}} = (-1)^{m+n} 2^{m} \frac{\Gamma(m + n + \chi + \frac{1}{2})}{\Gamma(n + \chi + \frac{1}{2})}.\qquad \text{Q.E.D.}\] <p>This relation has been validated by numerical calculations.</p> <h1 id="implications">Implications</h1> <p>This strange little identity associates \(P_\ell^m(z)\) with exactly one \(z^\chi s^m P_n^{(\chi - \frac{1}{2}, m)}(2s^2 - 1)\). As indicated in the title, this relation is likely of little use elsewhere. In the cylindrical to spherical transforms that we need in \(\Psi\)G model and other QG models, both of these bases are natural basis functions in their respective coordinate systems. Outside of this domain, such transforms may be of little use. Therefore I have never seen such relation in any standard special function books or online resources.</p> <p>The implication for our problem is that, if we consider the relation</p> \[f = \sum_{m,n} f_{mn}^s s^m P_n^{(-\frac{1}{2}, m)}(2s^2 - 1) + \sum_{m,n} f_{mn}^a z s^m P_n^{(\frac{1}{2}, m)}(2s^2 - 1) = \sum_{\ell,m} q_{\ell m} P_\ell^m(z)\] <p>the transform matrix \(\mathbf{M}_s^c\) (meaning spherical to cylindrical), defined by</p> \[\mathbf{f} = \mathbf{M}_s^c \mathbf{q}\] <p>is particularly simple. In fact, if we arrange the coordinates accordingly such that they are grouped by their symmetry with respect to the equatorial plane, i.e.</p> \[\mathbf{f} = \begin{pmatrix} \mathbf{f}^s \\ \mathbf{f}^a \end{pmatrix}, \qquad \mathbf{q} = \begin{pmatrix} \mathbf{q}_{\ell - m =2n} \\ \mathbf{q}_{\ell - m = 2n+1} \end{pmatrix}\] <p>then \(\mathbf{M}_s^c\) is simply diagonal. As a result, its, the cylindrical to spherical tranform \(\mathbf{M}_c^s\), is also diagonal.</p> <p>For other choices of \(\alpha\) and \(\beta\), notice the identity concerning Jacobi polynomials</p> \[\begin{gathered} (2n + \alpha + \beta + 1) P_n^{(\alpha, \beta)} = (n + \alpha + \beta + 1) P_n^{(\alpha, \beta + 1)} + (n + \alpha) P_{n-1}^{(\alpha, \beta + 1)} \\ (2n + \alpha + \beta + 1) P_n^{(\alpha, \beta)} = (n + \alpha + \beta + 1) P_n^{(\alpha + 1, \beta)} - (n + \beta) P_{n-1}^{(\alpha + 1, \beta)} \end{gathered}\] <p>Hence if we choose in equation (1) \(\alpha^s + \frac{1}{2}, \alpha^a - \frac{1}{2}, \beta^s - m, \beta^a - m \in \mathbb{Z}_{\geq 0}\), then the resulting transform matrix \(\mathbf{M}_s^c\) will be banded, with upper triangular bands. The intuition is that now one associated Legendre polynomial is "spread" to \(P_n^{(\alpha, \beta)}\) and several of its adjacent lower degrees (\(n\)), but not to all lower degree polynomials. The inverse \(\mathbf{M}_c^s\) at this point is unfortunately already dense upper triangular; each one-sided Jacobi polynomial will have its signature in all associated Legendre polynomials up to a certain degree \(l\), defined by \(l = m + 2n + \chi\).</p> <p>In the most general case, both \(\mathbf{M}_{c}^s\) and \(\mathbf{M}_s^c\) are dense upper triangular. Each \(P_\ell^m\) will induce all one-sided Jacobi polynomials with \(n\) up to the degree \(\lfloor (l-m)/2 \rfloor\), and each one-sided Jacobi polynomial will induce all \(P_\ell^m\) with \(\ell\) up to the degree \(m + 2n + \chi\). Note however that these are of course still band-limited, in the sense that the modes induced have a truncation degree in each direction (\(c\rightarrow s\) and \(s\rightarrow c\)), hence the matrices are always upper triangular. This is of course expected because deep down (stripping off all the \(s\) and \(z\) prefactors in each basis), the transform is just between two set of polynomials with their respective orthogonality. Therefore any polynomial should be representable by another set of orthogonal polynomial up to a certain truncation level (i.e. the band width).</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Jingtao Min. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. <a href="https://hits.sh/gentlemin.github.io_notes/assoc_legendre_jacobi.md" rel="external nofollow noopener" target="_blank"><img alt="Hits" src="https://hits.sh/gentlemin.github.io_notes/assoc_legendre_jacobi.md.svg?color=9277f0"></a> </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script> <script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{})});</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>