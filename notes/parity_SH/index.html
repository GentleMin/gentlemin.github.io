<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="XwhPCxJ23A4vdp_xBFDnsoJelhGwCPELOda48Hw_GLQ"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Parity of spherical harmonics | Geowanderer | Jingtao Min Homepage</title> <meta name="author" content="Jingtao Min"> <meta name="description" content="z-parity of spherical harmonics and poloidal toroidal fields expressed in spherical harmonics"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://gentlemin.github.io/notes/parity_SH/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Geowanderer</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/notes/">Notes</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repos</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/publications/">Publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/teaching/">Teaching</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Parity of spherical harmonics</h1> <p class="post-description">z-parity of spherical harmonics and poloidal toroidal fields expressed in spherical harmonics</p> </header> <article> <p>In this note I investigate the parity of a spherical harmonic mode with respect to the equatorial plane (\(z=0\)). The parity arises in the context of solving eigenvalue problems in a sphere. When solutions of different parities decouple, the system can be reduced to a smaller size, thus reducing the computation cost.</p> <hr> <h2 id="scalars-in-spherical-harmonic-expansion">Scalars in spherical harmonic expansion</h2> <p>Define <strong>reversion of the \(z\)-component</strong> of a vector field</p> \[\mathcal{R}: \begin{pmatrix} a_x \\ a_y \\ a_z \end{pmatrix} \mapsto \begin{pmatrix} a_x \\ a_y \\ -a_z \end{pmatrix}\] <p>When this operator is applied to the position vector, it equivalently constructs the inversion with respect to the equatorial plane, as</p> \[\mathcal{R}\begin{pmatrix} x \\ y \\ z\end{pmatrix} = \begin{pmatrix} x\\ y \\ -z \end{pmatrix}\] <p>such that it is equivalent to the following transform in coordinates:</p> \[\mathcal{R}: \quad z \mapsto -z,\qquad \theta \mapsto \pi - \theta\] <p>Define \(\mathcal{S}\) as the space of scalar fields that are symmetric (even) w.r.t. the equatorial plane, i.e.</p> \[f(\mathbf{r}) = f(\mathcal{R}\mathbf{r}),\quad \forall F \in \mathcal{S}\] <p>and \(\mathcal{A}\) as the space of scalar fields that are anti-symmetric (odd) w.r.t. the equatorial plane,</p> \[f(\mathbf{r}) = -f(\mathcal{R}\mathbf{r}),\quad \forall F \in \mathcal{A}\] <p>First of all, we note the following <strong>property</strong>:</p> \[\begin{aligned} f(\mathbf{r}) \, g(\mathbf{r}) &amp;\in \mathcal{A}, \quad \forall f \in \mathcal{A}, g \in \mathcal{S} \\ f(\mathbf{r}) \, g(\mathbf{r}) &amp;\in \mathcal{S}, \quad \forall f, g \in \mathcal{A} \\ f(\mathbf{r}) \, g(\mathbf{r}) &amp;\in \mathcal{S}, \quad \forall f, g \in \mathcal{S} \end{aligned}\] <p>This just inherits from the property of even and odd functions. Even factors keep the parity of the original field, while odd factors flip the parity of the original field. A purely radially varying scalar field is always an even field. Therefore, a natural consequence is <strong>that any radially varying factors do NOT affect the parity of the scalar field</strong>. Now we consider the spherical harmonic expansion of a scalar field</p> \[f(\mathbf{r}) = \sum_{l,m} f_l^m(\mathbf{r}) =\sum_{l,m} f_l^m(r) \, Y_l^m(\theta, \phi)\] <p>Since the radially varying SH coefficients do not affect the parity of the overall field, the parity of the SH components can be simplified to studying the parity of the SH basis function itself. Note that \(Y_l^m(\theta, \phi) = P_l^m(\cos\theta) e^{im\phi}\); therefore, the parity of spherical harmonics directly inherits from the even/odd property of the associated Legendre function. Using</p> \[P_l^m(-x) = (-1)^{l-m} P_l^m(x)\] <p>we have the parity of the spherical harmonics:</p> \[Y_l^m(-\theta,\phi) = (-1)^{l-m} Y_l^m(\theta, \phi)\] <p>This translates to the following symmetry:</p> <ul> <li>\(Y_l^m \in \mathcal{S}\) / even / symmetric w.r.t. the equatorial plane, when \(l-m\) is even, or \(l\equiv m \,(\mathrm{mod} 2)\);</li> <li>\(Y_l^m \in \mathcal{A}\) / odd / anti-symm w.r.t. the equatorial plane, when \(l-m\) is odd, or \(l\equiv m + 1 \, (\mathrm{mod} 2)\).</li> </ul> <hr> <h2 id="vectors-fields-described-by-spherical-harmonics">Vectors fields described by spherical harmonics</h2> <p>For a vector field, the notion of symmetry with respect to the equatorial plane requires an additional reversion of the field itself. The space \(\mathcal{S}_1\) will be used for denoting a space of vector fields who has mirror symmetry w.r.t. the equatorial plane, or</p> \[\mathbf{F}(\mathbf{r}) = \mathcal{R} \mathbf{F}(\mathcal{R}\mathbf{r}),\quad \forall \mathbf{F} \in \mathcal{S}_1\] <p>while \(\mathcal{A}_1\) denotes a space of vector fields which is mirror anti-symmetric w.r.t. the equatorial plane,</p> \[\mathbf{F}(\mathbf{r}) = -\mathcal{R} \mathbf{F}(\mathcal{R}\mathbf{r}),\quad \forall \mathbf{F} \in \mathcal{A}_1\] <p>The symmetric / even class \(\mathcal{S}_1\) is referred to as “quadrupole-like” (<em>QP</em>) in Jiawen’s papers, and the anti-symmetric / odd class \(\mathcal{A}_1\) is referred to as “dipole-like” (<em>DP</em>) in Jiawen’s papers. To be more explicit, writing it in component form</p> \[\begin{gathered} \mathbf{F} \in \mathcal{S}_1 \quad \Longleftrightarrow \quad F_e \in \mathcal{S},\quad F_z \in \mathcal{A} \\ \mathbf{F} \in \mathcal{A}_1 \quad \Longleftrightarrow \quad F_e \in \mathcal{A},\quad F_z \in \mathcal{S} \end{gathered}\] <p>where \(F_e\) denotes any equatorial component of the field.</p> <h3 id="toroidal-vector-fields">Toroidal vector fields</h3> <p>Consider a toroidal vector field \(\mathbf{F} \in \mathcal{T}\), and hence</p> \[\mathbf{F} = \nabla\times (T \mathbf{r}) = -\hat{r}\times \nabla_s T = -\frac{\partial T}{\partial \theta} \hat{\phi} + \frac{1}{\sin\theta}\frac{\partial T}{\partial \phi} \hat{\theta} = \frac{z}{s} \frac{\partial T}{\partial \phi} \hat{s} - \frac{\partial T}{\partial \theta} \hat{\phi} - \frac{\partial T}{\partial \phi} \hat{z}\] <p>For the toroidal field, the surface curl \(\hat{\mathbf{r}}\times \nabla_s\) commutes with any function of \(r\) (see e.g. [[Vector Representation]]); hence, each spherical harmonic can be written as the radially varying factor multiplied by the surface curl operated on the spherical harmonics, which is really just the vector spherical harmonics. Here however I explicitly write out the component</p> \[\mathbf{F}_l^m = t_l^m(r) \left[\left(im\frac{z}{s} Y_l^m\, \hat{s} - \frac{\partial Y_l^m}{\partial \theta} \hat{\phi}\right) - im Y_l^m\, \hat{z}\right]\] <p>In the first bracket I grouped the horizontal components, and the vertical component is put aside. The question now boils down to determining the parity of the components. To be more precise, we only care about the symmetry properties of \(zY_l^m/s\), \(\partial_\theta Y_l^m\) and \(Y_l^m\). For the last one, we have</p> \[Y_l^m \in \left\{\begin{aligned} \mathcal{S},\quad l-m\equiv 0\,(\mathrm{mod} 2) \\ \mathcal{A},\quad l-m\equiv 1\,(\mathrm{mod} 2) \end{aligned}\right.\] <p>This variable corresponds to the vertical component. The second term inherits its parity from the odd/even property of \(\partial_\theta P_l^m(\cos\theta)\), which ultimately can be derived from symmetry of \(P_l^m(\cos\theta)\):</p> \[\frac{\partial Y_l^m}{\partial\theta} \in \left\{\begin{aligned} \mathcal{A},\quad l-m\equiv 0\,(\mathrm{mod} 2) \\ \mathcal{S},\quad l-m\equiv 1\,(\mathrm{mod} 2) \end{aligned}\right.\] <p>And finally, combining the parity of \(Y_l^m\), and the odd parity of the factor \(z\), we have</p> \[\frac{z}{s} Y_l^m \in \left\{\begin{aligned} \mathcal{A},\quad l-m\equiv 0\,(\mathrm{mod} 2) \\ \mathcal{S},\quad l-m\equiv 1\,(\mathrm{mod} 2) \end{aligned}\right.\] <p>Combining all three relations together, we have the following parity of the spherical harmonic components of the toroidal field:</p> \[\begin{aligned} l-m\equiv 0 \, (\mathrm{mod}\, 2) \quad &amp;\Longleftrightarrow \quad F_{le}^m \in \mathcal{A},\, F_{lz}^m \in \mathcal{S}, \quad \Longleftrightarrow\quad \mathbf{F}_l^m \in \mathcal{A}_1 \\ l-m\equiv 1 \, (\mathrm{mod}\, 2) \quad &amp;\Longleftrightarrow \quad F_{le}^m \in \mathcal{S},\, F_{lz}^m \in \mathcal{A}, \quad \Longleftrightarrow \quad \mathbf{F}_l^m \in \mathcal{S}_1 \end{aligned}\] <h3 id="poloidal-vector-field">Poloidal vector field</h3> <p>Consider a poloidal vector field \(\mathbf{F} \in \mathcal{P}\), and hence</p> \[\begin{aligned} \mathbf{F} &amp;= \nabla\times \nabla\times (P\mathbf{r}) = \nabla_s\left(\frac{1}{r}\frac{\partial (rP)}{\partial r}\right) - \hat{\mathbf{r}} \nabla_s^2 \frac{P}{r} \\ &amp;= \frac{1}{r}\frac{\partial^2 (rP)}{\partial r\partial\theta} \hat{\theta} + \frac{1}{r\sin\theta} \frac{\partial^2 (rP)}{\partial r \partial \phi} \hat{\phi} - \hat{\mathbf{r}} \nabla_s^2 \frac{P}{r} \\ &amp;= \left[\frac{1}{r}\frac{\partial^2 (rP)}{\partial r\partial\theta} \cos\theta -\sin\theta \nabla_s^2 \frac{P}{r}\right] \hat{\mathbf{s}} + \frac{1}{r\sin\theta} \frac{\partial^2 (rP)}{\partial r \partial \phi} \hat{\phi} \\ &amp;\quad + \left[-\frac{1}{r}\frac{\partial^2 (rP)}{\partial r\partial\theta} \sin\theta -\cos\theta \nabla_s^2 \frac{P}{r} \right] \hat{\mathbf{z}} \\ &amp;= \left[\frac{z}{r^2}\frac{\partial^2 (rP)}{\partial r\partial\theta} - \frac{s}{r^2} \nabla_s^2 P \right] \hat{\mathbf{s}} + \frac{1}{s} \frac{\partial^2 (rP)}{\partial r \partial \phi} \hat{\phi} \\ &amp;\quad + \left[-\frac{s}{r^2}\frac{\partial^2 (rP)}{\partial r\partial\theta} -\frac{z}{r^2} \nabla_s^2 P \right] \hat{\mathbf{z}} \end{aligned}\] <p>Expanding the scalar \(P = \sum_{l,m} p_l^m(r) Y_l^m(\theta, \phi)\), we can isolate each spherical harmonic component</p> \[\begin{aligned} \mathbf{F}_l^m &amp;= \left[\frac{d(rp_l^m)}{dr} \frac{z}{r^2} \frac{\partial Y_l^m}{\partial \theta} + l(l+1) \frac{s}{r^2} p_l^m Y_l^m \right] \hat{\mathbf{s}} + \frac{im}{s}\frac{d(rp_l^m)}{dr} Y_l^m \hat{\phi} \\ &amp;+ \left[-\frac{d(rp_l^m)}{dr} \frac{s}{r^2} \frac{\partial Y_l^m}{\partial \theta} + l(l+1) \frac{z}{r^2} p_l^m Y_l^m\right] \hat{\mathbf{z}} \end{aligned}\] <p>The question now boils down to determining the parity of the components. In this case, we only care about the symmetry properties of \(Y_l^m\), \(zY_l^m\), \(\partial_\theta Y_l^m\) and \(z\partial_\theta Y_l^m\). The parity of the first three quantities are already given in previous discussions. The only new thing here is the last one. Combining the parity of \(\partial_\theta Y_l^m\), and the odd parity of the factor \(z\), we have</p> \[z \frac{\partial Y_l^m}{\partial\theta} \in \left\{\begin{aligned} \mathcal{S},\quad l-m\equiv 0\,(\mathrm{mod} 2) \\ \mathcal{A},\quad l-m\equiv 1\,(\mathrm{mod} 2) \end{aligned}\right.\] <p>Combining all relations together, we have the following parity of the spherical harmonic components of the poloidal field:</p> \[\begin{aligned} l-m\equiv 0 \, (\mathrm{mod}\, 2) \quad &amp;\Longleftrightarrow \quad F_{le}^m \in \mathcal{S},\, F_{lz}^m \in \mathcal{A}, \quad \Longleftrightarrow\quad \mathbf{F}_l^m \in \mathcal{S}_1 \\ l-m\equiv 1 \, (\mathrm{mod}\, 2) \quad &amp;\Longleftrightarrow \quad F_{le}^m \in \mathcal{A},\, F_{lz}^m \in \mathcal{S}, \quad \Longleftrightarrow \quad \mathbf{F}_l^m \in \mathcal{A}_1 \end{aligned}\] </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Jingtao Min. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. <a href="https://hits.sh/gentlemin.github.io_notes/parity_SH.md" rel="external nofollow noopener" target="_blank"><img alt="Hits" src="https://hits.sh/gentlemin.github.io_notes/parity_SH.md.svg?color=9277f0"></a> </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script> <script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{})});</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>