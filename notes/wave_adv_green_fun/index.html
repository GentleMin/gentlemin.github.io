<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="XwhPCxJ23A4vdp_xBFDnsoJelhGwCPELOda48Hw_GLQ"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Green's function for advection-wave equation | Geowanderer | Jingtao Min Homepage</title> <meta name="author" content="Jingtao Min"> <meta name="description" content="Green's function for wave equation with advection in 1D infinite domain"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://gentlemin.github.io/notes/wave_adv_green_fun/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Geowanderer</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/notes/">Notes</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repos</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/publications/">Publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/teaching/">Teaching</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Green's function for advection-wave equation</h1> <p class="post-description">Green's function for wave equation with advection in 1D infinite domain</p> </header> <article> <p>In its general form, the advection-wave equation of a scalar field \(p(\mathbf{r})\) reads</p> \[\frac{\partial^2 p}{\partial t^2} + 2 \mathbf{u} \cdot \nabla \frac{\partial p}{\partial t} - a \nabla\cdot (b\nabla p) = f\] <p>It is a second-order (in time and space) linear partial differential equation (PDE) in \(p\). Here I only look at the homogeneous case, where \(a\) and \(b\) are merely constants. In this case we have</p> \[\frac{\partial^2 p}{\partial t^2} + 2 \mathbf{u} \cdot \nabla \frac{\partial p}{\partial t} - c^2 \nabla^2 p = f\] <p>where \(c\) is the wave speed.</p> <h1 id="greens-function-for-1d-advection-wave-equation-in-infinite-domain">Green’s function for 1D advection-wave equation in infinite domain</h1> <p>The equation in 1D reads</p> \[\frac{\partial^2 p}{\partial t^2} + 2 v \frac{\partial^2 p}{\partial x \partial t} - c^2 \frac{\partial^2 p}{\partial x^2} = f\] <p>The corresponding problem for the Green’s function \(g(x, t; x', t')\) is</p> \[\begin{aligned} &amp;\text{Equation:}\quad &amp; &amp;\frac{\partial^2 g}{\partial t^2} + 2 v \frac{\partial^2 g}{\partial x \partial t} - c^2 \frac{\partial^2 g}{\partial x^2} = \delta(t-t') \delta(x-x') \\[5pt] &amp;\text{Initial condition:}\quad &amp; &amp;g|_{t&lt;t'} = 0, \quad \partial_t g|_{t&lt;t'} = 0 \\[8pt] &amp;\text{Boundary condition:}\quad &amp; &amp;g|_{x\rightarrow +\infty} = 0, \quad g|_{x\rightarrow -\infty} = 0 \end{aligned}\] <p>In the situation where \(v &lt; c\), the Green’s function can be solved to be</p> \[\begin{aligned} g(x,t;x',t') &amp;= \frac{H(t-t')}{2\sqrt{c^2 + v^2}} \left[H\left(t-t' - \frac{x - x'}{\sqrt{c^2 + v^2} + v}\right) + H\left(t-t' + \frac{x - x'}{\sqrt{c^2 + v^2} - v}\right) - 1\right] \\ &amp;= \frac{H(t-t')}{2\sqrt{c^2 + v^2}} \, \mathbb{1} \left(-(\sqrt{c^2 + v^2} - v) &lt; \frac{x - x'}{t - t'} &lt; \sqrt{c^2 + v^2} + v\right) \end{aligned}\] <p>where \(H(\cdot)\) is the Heaviside step function, taking value of \(1\) when argument \(&gt; 0\) and otherwise zero, and \(\mathbb{1}(\cdot)\) is the indicator function, taking value of \(1\) when the argument condition is satisfied, otherwise zero. If we introduce Mach number</p> \[\mathrm{M} = \frac{v}{c} &lt; 1\] <p>The Green’s function can be rewritten as</p> \[\begin{aligned} g(x,t;x',t') &amp;= \frac{H(t-t')}{2c\sqrt{1 + \mathrm{M}^2}} \left[H\left(t-t' - \frac{x - x'}{c(\sqrt{1 + \mathrm{M}^2} + \mathrm{M})}\right) + H\left(t-t' + \frac{x - x'}{c(\sqrt{1 + \mathrm{M}^2} - \mathrm{M})}\right) - 1\right] \\ &amp;= \frac{H(t-t')}{2c\sqrt{1 + \mathrm{M}^2}} \, \mathbb{1} \left(-c(\sqrt{1 + \mathrm{M}^2} - \mathrm{M}) &lt; \frac{x - x'}{t - t'} &lt; c(\sqrt{1 + \mathrm{M}^2} + \mathrm{M})\right). \end{aligned}\] <p>The interpretation of this 1D Green’s function is very straightforward. The pertubation at time \(t'\) and position \(x'\) will travel upwind (=against the advection direction) with a velocity \(\sqrt{c^2 + v^2} - v = c (\sqrt{1 + \mathrm{M}^2} - \mathrm{M})\) slightly greater than the wave speed, and downwind (=following the advection direction) with a velocity \(\sqrt{c^2 + v^2} + v = c (\sqrt{1 + \mathrm{M}^2} + \mathrm{M})\), slightly lower than the wave speed. The propagation of the pertubation in both direction takes the form of a step function, with a constant amplitude \(1/(2\sqrt{c^2 + v^2}) = 1/(2c\sqrt{1 + \mathrm{M}^2})\). I leave the derivation in the back.</p> <h2 id="zeroth-order-approximation">Zeroth-order approximation</h2> <p>At Mach number \(\mathrm{M} = 0\), the system degenerates to the original wave equation with no advection; the Green’s function can be immediately obtained by setting \(\mathrm{M} = 0\) in the expression above:</p> \[\begin{aligned} g(x,t;x',t') &amp;= \frac{H(t-t')}{2c} \left[H\left(t-t' - \frac{x - x'}{c}\right) + H\left(t-t' + \frac{x - x'}{c}\right) - 1\right] \\ &amp;= \frac{H(t-t')}{2c} \, \mathbb{1} \left(-c &lt; \frac{x - x'}{t - t'} &lt; c\right). \end{aligned}\] <h2 id="first-order-approximation">First-order approximation</h2> <p>At Mach number \(\mathrm{M} \ll 1\), \(\sqrt{1 + \mathrm{M}^2} \sim 1 + \frac{1}{2} \mathrm{M}^2\), and hence only deviates from \(1\) by a second-order term. If we keep only the first-order terms, then</p> \[\begin{aligned} g(x,t;x',t') &amp;= \frac{H(t-t')}{2c} \left[H\left(t-t' - \frac{x - x'}{c + v}\right) + H\left(t-t' + \frac{x - x'}{c - v}\right) - 1\right] \\ &amp;= \frac{H(t-t')}{2c} \left[H\left(t-t' - \frac{x - x'}{c(1 + \mathrm{M})}\right) + H\left(t-t' + \frac{x - x'}{c(1 - \mathrm{M})}\right) - 1\right] \\ &amp;= \frac{H(t-t')}{2c} \, \mathbb{1} \left(-(c - v) &lt; \frac{x - x'}{t - t'} &lt; c + v\right) \\ &amp;= \frac{H(t-t')}{2c} \, \mathbb{1} \left(-c(1 - \mathrm{M}) &lt; \frac{x - x'}{t - t'} &lt; c(1 + \mathrm{M})\right) \end{aligned}\] <p>At this order the pertubations simply propagate at speeds \(c + v\) and \(c - v\) in each direction. It should however be noted that here the approximation in the propgation velocity has been used. This approximation is not uniformly valid at large distance / long propgation time, but only up to a certain distance / time that scales with \(\mathrm{M}^{-1}\).</p> <h2 id="derivation-of-the-greens-function">Derivation of the Green’s function</h2> <p>Here I follow what I believe is a relatively rigorous route to derive the Green’s function. Only key steps are shown. In accordance with the infinite domain and the boundary condition at \(\pm \infty\), we can Fourier transform the PDE into the wavenumber domain</p> \[\mathscr{F}[\cdot]: \quad \mapsto \quad \frac{\partial^2 \tilde{g}}{\partial t^2} + 2ikv \frac{\partial \tilde{g}}{\partial x} + k^2 c^2 \tilde{g} = \frac{e^{-ikx'}}{\sqrt{2\pi}} \delta(t - t')\] <p>where</p> \[\tilde{g}(k,t;x',t) = \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{+\infty} g(x,t;x',t') e^{-ikx} \, dx\] <p>is the Fourier transformed Green’s function in wavenumber domain. Now the PDE is converted to an ODE initial value problem (IVP). The solution to this problem reads</p> \[\tilde{g}(k,t;x',t) = \frac{e^{-ikx'}}{k\sqrt{2\pi (c^2 + v^2)}} e^{-ikv(t - t')} \sin \left(k\sqrt{c^2 + v^2} (t - t')\right) H(t-t')\] <p>The final step is then to convert this back to space domain using an inverse Fourier transform</p> \[\begin{aligned} g(x,t;x',t') &amp;= \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{+\infty} \tilde{g}(k,t;x',t) \, e^{ikx} dk \\ &amp;= \frac{H(t - t')}{2\pi \sqrt{c^2 + v^2}} \int_{-\infty}^{+\infty} \sin \left(k\sqrt{c^2 + v^2} (t - t')\right) \exp\left(-ikv\left(t - t' - \frac{x - x'}{v}\right)\right) \, \frac{dk}{k} \end{aligned}\] <p>This can be written as a combination of \(\int_\mathbb{R} \frac{e^{ipk}}{k}dk\) integrals and evaluated using the residual theorem and Jordan’s lemma. Evaluation of this integral yields the answer.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Jingtao Min. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. <a href="https://hits.sh/gentlemin.github.io_notes/wave_adv_green_fun.md" rel="external nofollow noopener" target="_blank"><img alt="Hits" src="https://hits.sh/gentlemin.github.io_notes/wave_adv_green_fun.md.svg?color=9277f0"></a> </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script> <script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{})});</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>